# .github/workflows/discord-examples.yml
name: Notify Discord about examples updates

on:
  push:
    branches: [main]
    paths:
      - 'examples/**'
jobs:
  discord-notify:
    if: github.event.pull_request.merged == true
    runs-on: ubuntu-latest

    steps:
      - name: Send message to Discord
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_HOOK }}
          PR_URL:          ${{ github.event.pull_request.html_url }}
          PR_TITLE:        ${{ github.event.pull_request.title }}
          PR_NUMBER:       ${{ github.event.pull_request.number }}
          PR_AUTHOR:       ${{ github.event.pull_request.user.login }}
        run: |
          CONTENT=$(jq -n \
            --arg content "ðŸ”” **Fresh Gno code just dropped!**
          
          **$PR_TITLE** (#$PR_NUMBER) by <https://github.com/$PR_AUTHOR>
          <$PR_URL>" \
          '{content: $content}'
          )
          
          curl -X POST \
         -H "Content-Type: application/json" \
          -d "$CONTENT" \
          "$DISCORD_WEBHOOK"
